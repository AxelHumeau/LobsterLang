<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
-- EPITECH PROJECT, 2023
-- GLaDOS
-- File description:
-- Environment
-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Scope</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier">ScopeMb</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Scope.html#beginScope"><span class="hs-identifier">beginScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Scope.html#clearScope"><span class="hs-identifier">clearScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Scope.html#addVarToScope"><span class="hs-identifier">addVarToScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Scope.html#getVarInScope"><span class="hs-identifier">getVarInScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Scope.html#addVarsToScope"><span class="hs-identifier">addVarsToScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Scope.html#updateVar"><span class="hs-identifier">updateVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="AST.html"><span class="hs-identifier">AST</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Stack.html"><span class="hs-identifier">Stack</span></a></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- | Structure representing a member in a scope.</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- Can be a 'ScopeBegin' to mark the beginning of a scope or</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- a 'Variable' containing its name as a 'String' and its value as an 'Ast'</span><span>
</span><span id="line-25"></span><span class="hs-keyword">data</span><span> </span><span id="ScopeMb"><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-var">ScopeMb</span></a></span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ScopeBegin"><span class="annot"><a href="Scope.html#ScopeBegin"><span class="hs-identifier hs-var">ScopeBegin</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Variable"><span class="annot"><a href="Scope.html#Variable"><span class="hs-identifier hs-var">Variable</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="AST.html#Ast"><span class="hs-identifier hs-type">Ast</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065959"><span id="local-6989586621679065966"><span class="annot"><span class="annottext">ScopeMb -&gt; ScopeMb -&gt; Bool
(ScopeMb -&gt; ScopeMb -&gt; Bool)
-&gt; (ScopeMb -&gt; ScopeMb -&gt; Bool) -&gt; Eq ScopeMb
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ScopeMb -&gt; ScopeMb -&gt; Bool
== :: ScopeMb -&gt; ScopeMb -&gt; Bool
$c/= :: ScopeMb -&gt; ScopeMb -&gt; Bool
/= :: ScopeMb -&gt; ScopeMb -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065971"><span id="local-6989586621679065984"><span id="local-6989586621679065988"><span class="annot"><span class="annottext">Int -&gt; ScopeMb -&gt; ShowS
[ScopeMb] -&gt; ShowS
ScopeMb -&gt; String
(Int -&gt; ScopeMb -&gt; ShowS)
-&gt; (ScopeMb -&gt; String) -&gt; ([ScopeMb] -&gt; ShowS) -&gt; Show ScopeMb
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ScopeMb -&gt; ShowS
showsPrec :: Int -&gt; ScopeMb -&gt; ShowS
$cshow :: ScopeMb -&gt; String
show :: ScopeMb -&gt; String
$cshowList :: [ScopeMb] -&gt; ShowS
showList :: [ScopeMb] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="annot"><span class="hs-comment">-- | Get the depth of a member in a scope</span></span><span>
</span><span id="line-31"></span><span class="annot"><a href="Scope.html#getDepth"><span class="hs-identifier hs-type">getDepth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-type">ScopeMb</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-32"></span><span id="getDepth"><span class="annot"><span class="annottext">getDepth :: [ScopeMb] -&gt; Int
</span><a href="Scope.html#getDepth"><span class="hs-identifier hs-var hs-var">getDepth</span></a></span></span><span> </span><span id="local-6989586621679065993"><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679065993"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[ScopeMb] -&gt; Maybe ScopeMb
forall a. [a] -&gt; Maybe a
</span><a href="Stack.html#top"><span class="hs-identifier hs-var">top</span></a></span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679065993"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scope.html#ScopeBegin"><span class="hs-identifier hs-type">ScopeBegin</span></a></span><span> </span><span id="local-6989586621679065995"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065995"><span class="hs-identifier hs-var">depth</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065995"><span class="hs-identifier hs-var">depth</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scope.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Ast
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679065996"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065996"><span class="hs-identifier hs-var">depth</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679065996"><span class="hs-identifier hs-var">depth</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><span class="annottext">Maybe ScopeMb
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="annot"><span class="hs-comment">-- | Begin a new scope by adding a 'ScopeBegin' to the stack.</span></span><span>
</span><span id="line-38"></span><span class="annot"><a href="Scope.html#beginScope"><span class="hs-identifier hs-type">beginScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-type">ScopeMb</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-type">ScopeMb</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-39"></span><span id="beginScope"><span class="annot"><span class="annottext">beginScope :: [ScopeMb] -&gt; [ScopeMb]
</span><a href="Scope.html#beginScope"><span class="hs-identifier hs-var hs-var">beginScope</span></a></span></span><span> </span><span id="local-6989586621679065997"><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679065997"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ScopeMb] -&gt; ScopeMb -&gt; [ScopeMb]
forall a. [a] -&gt; a -&gt; [a]
</span><a href="Stack.html#push"><span class="hs-identifier hs-var">push</span></a></span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679065997"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ScopeMb
</span><a href="Scope.html#ScopeBegin"><span class="hs-identifier hs-var">ScopeBegin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ScopeMb] -&gt; Int
</span><a href="Scope.html#getDepth"><span class="hs-identifier hs-var">getDepth</span></a></span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679065997"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="annot"><span class="hs-comment">-- | Clear the current scope</span></span><span>
</span><span id="line-42"></span><span class="annot"><a href="Scope.html#clearScope"><span class="hs-identifier hs-type">clearScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-type">ScopeMb</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-type">ScopeMb</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-43"></span><span id="clearScope"><span class="annot"><span class="annottext">clearScope :: [ScopeMb] -&gt; [ScopeMb]
</span><a href="Scope.html#clearScope"><span class="hs-identifier hs-var hs-var">clearScope</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-44"></span><span class="annot"><a href="Scope.html#clearScope"><span class="hs-identifier hs-var">clearScope</span></a></span><span> </span><span id="local-6989586621679066000"><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066000"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[ScopeMb] -&gt; (Maybe ScopeMb, [ScopeMb])
forall a. [a] -&gt; (Maybe a, [a])
</span><a href="Stack.html#pop"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066000"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ScopeMb
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679066002"><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066002"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066002"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scope.html#ScopeBegin"><span class="hs-identifier hs-type">ScopeBegin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679066003"><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066003"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066003"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">ScopeMb
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679066004"><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066004"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ScopeMb] -&gt; [ScopeMb]
</span><a href="Scope.html#clearScope"><span class="hs-identifier hs-var">clearScope</span></a></span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066004"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- | Add a Variable to the stack with its name as a 'String'</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- and its value by an 'Ast'</span><span>
</span><span id="line-51"></span><span class="annot"><a href="Scope.html#addVarToScope"><span class="hs-identifier hs-type">addVarToScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-type">ScopeMb</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#Ast"><span class="hs-identifier hs-type">Ast</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-type">ScopeMb</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-52"></span><span id="addVarToScope"><span class="annot"><span class="annottext">addVarToScope :: [ScopeMb] -&gt; String -&gt; Ast -&gt; [ScopeMb]
</span><a href="Scope.html#addVarToScope"><span class="hs-identifier hs-var hs-var">addVarToScope</span></a></span></span><span> </span><span id="local-6989586621679066005"><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066005"><span class="hs-identifier hs-var">stack</span></a></span></span><span> </span><span id="local-6989586621679066006"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066006"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679066007"><span class="annot"><span class="annottext">Ast
</span><a href="#local-6989586621679066007"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ScopeMb] -&gt; ScopeMb -&gt; [ScopeMb]
forall a. [a] -&gt; a -&gt; [a]
</span><a href="Stack.html#push"><span class="hs-identifier hs-var">push</span></a></span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066005"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Ast -&gt; Int -&gt; ScopeMb
</span><a href="Scope.html#Variable"><span class="hs-identifier hs-var">Variable</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066006"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Ast
</span><a href="#local-6989586621679066007"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[ScopeMb] -&gt; Int
</span><a href="Scope.html#getDepth"><span class="hs-identifier hs-var">getDepth</span></a></span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066005"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-54"></span><span>  </span><span id="local-6989586621679066008"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066008"><span class="hs-identifier hs-var">depth</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066008"><span class="hs-identifier hs-var">depth</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- | Add multiple variables to the stack with their names as a 'String'</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- and their values as an 'Ast'</span><span>
</span><span id="line-59"></span><span class="annot"><a href="Scope.html#addVarsToScope"><span class="hs-identifier hs-type">addVarsToScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-type">ScopeMb</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Ast"><span class="hs-identifier hs-type">Ast</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-type">ScopeMb</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-60"></span><span id="addVarsToScope"><span class="annot"><span class="annottext">addVarsToScope :: [ScopeMb] -&gt; [String] -&gt; [Ast] -&gt; [ScopeMb]
</span><a href="Scope.html#addVarsToScope"><span class="hs-identifier hs-var hs-var">addVarsToScope</span></a></span></span><span> </span><span id="local-6989586621679066009"><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066009"><span class="hs-identifier hs-var">stack</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Ast]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066009"><span class="hs-identifier hs-var">stack</span></a></span><span>
</span><span id="line-61"></span><span class="annot"><a href="Scope.html#addVarsToScope"><span class="hs-identifier hs-var">addVarsToScope</span></a></span><span> </span><span id="local-6989586621679066010"><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066010"><span class="hs-identifier hs-var">stack</span></a></span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066010"><span class="hs-identifier hs-var">stack</span></a></span><span>
</span><span id="line-62"></span><span class="annot"><a href="Scope.html#addVarsToScope"><span class="hs-identifier hs-var">addVarsToScope</span></a></span><span> </span><span id="local-6989586621679066011"><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066011"><span class="hs-identifier hs-var">stack</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066012"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066012"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679066013"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679066013"><span class="hs-identifier hs-var">xs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066014"><span class="annot"><span class="annottext">Ast
</span><a href="#local-6989586621679066014"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679066015"><span class="annot"><span class="annottext">[Ast]
</span><a href="#local-6989586621679066015"><span class="hs-identifier hs-var">xs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><span class="annottext">[ScopeMb] -&gt; ScopeMb -&gt; [ScopeMb]
forall a. [a] -&gt; a -&gt; [a]
</span><a href="Stack.html#push"><span class="hs-identifier hs-var">push</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ScopeMb] -&gt; [String] -&gt; [Ast] -&gt; [ScopeMb]
</span><a href="Scope.html#addVarsToScope"><span class="hs-identifier hs-var">addVarsToScope</span></a></span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066011"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679066013"><span class="hs-identifier hs-var">xs1</span></a></span><span> </span><span class="annot"><span class="annottext">[Ast]
</span><a href="#local-6989586621679066015"><span class="hs-identifier hs-var">xs2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Ast -&gt; Int -&gt; ScopeMb
</span><a href="Scope.html#Variable"><span class="hs-identifier hs-var">Variable</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066012"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Ast
</span><a href="#local-6989586621679066014"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ScopeMb] -&gt; Int
</span><a href="Scope.html#getDepth"><span class="hs-identifier hs-var">getDepth</span></a></span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066011"><span class="hs-identifier hs-var">stack</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="annot"><a href="Scope.html#seekAndUpdate"><span class="hs-identifier hs-type">seekAndUpdate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-type">ScopeMb</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#Ast"><span class="hs-identifier hs-type">Ast</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-type">ScopeMb</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-68"></span><span id="seekAndUpdate"><span class="annot"><span class="annottext">seekAndUpdate :: [ScopeMb] -&gt; Int -&gt; String -&gt; Ast -&gt; [ScopeMb]
</span><a href="Scope.html#seekAndUpdate"><span class="hs-identifier hs-var hs-var">seekAndUpdate</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066017"><span class="annot"><span class="annottext">ScopeMb
</span><a href="#local-6989586621679066017"><span class="hs-identifier hs-var">h</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066018"><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066018"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679066019"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066019"><span class="hs-identifier hs-var">depth</span></a></span></span><span> </span><span id="local-6989586621679066020"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066020"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679066021"><span class="annot"><span class="annottext">Ast
</span><a href="#local-6989586621679066021"><span class="hs-identifier hs-var">ast</span></a></span></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; ScopeMb -&gt; Bool
</span><a href="Scope.html#isSearchedVar"><span class="hs-identifier hs-var">isSearchedVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066020"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066019"><span class="hs-identifier hs-var">depth</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeMb
</span><a href="#local-6989586621679066017"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Ast -&gt; Int -&gt; ScopeMb
</span><a href="Scope.html#Variable"><span class="hs-identifier hs-var">Variable</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066020"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Ast
</span><a href="#local-6989586621679066021"><span class="hs-identifier hs-var">ast</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066019"><span class="hs-identifier hs-var">depth</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeMb -&gt; [ScopeMb] -&gt; [ScopeMb]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066018"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeMb
</span><a href="#local-6989586621679066017"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeMb -&gt; [ScopeMb] -&gt; [ScopeMb]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ScopeMb] -&gt; Int -&gt; String -&gt; Ast -&gt; [ScopeMb]
</span><a href="Scope.html#seekAndUpdate"><span class="hs-identifier hs-var">seekAndUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066018"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066019"><span class="hs-identifier hs-var">depth</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066020"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Ast
</span><a href="#local-6989586621679066021"><span class="hs-identifier hs-var">ast</span></a></span><span>
</span><span id="line-71"></span><span class="annot"><a href="Scope.html#seekAndUpdate"><span class="hs-identifier hs-var">seekAndUpdate</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Ast
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="annot"><span class="hs-comment">-- | Update the given variable, don't do anything if it doesn't exist</span></span><span>
</span><span id="line-74"></span><span class="annot"><a href="Scope.html#updateVar"><span class="hs-identifier hs-type">updateVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-type">ScopeMb</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#Ast"><span class="hs-identifier hs-type">Ast</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-type">ScopeMb</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-75"></span><span id="updateVar"><span class="annot"><span class="annottext">updateVar :: [ScopeMb] -&gt; String -&gt; Ast -&gt; [ScopeMb]
</span><a href="Scope.html#updateVar"><span class="hs-identifier hs-var hs-var">updateVar</span></a></span></span><span> </span><span id="local-6989586621679066023"><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066023"><span class="hs-identifier hs-var">stack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ScopeMb] -&gt; Int -&gt; String -&gt; Ast -&gt; [ScopeMb]
</span><a href="Scope.html#seekAndUpdate"><span class="hs-identifier hs-var">seekAndUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066023"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ScopeMb] -&gt; Int
</span><a href="Scope.html#getDepth"><span class="hs-identifier hs-var">getDepth</span></a></span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066023"><span class="hs-identifier hs-var">stack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | Get the value contained in the variable given by name as a 'String',</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- return 'Nothing' if the variable don't exist or 'Just' its value</span><span>
</span><span id="line-79"></span><span class="annot"><a href="Scope.html#getVarInScope"><span class="hs-identifier hs-type">getVarInScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-type">ScopeMb</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="AST.html#Ast"><span class="hs-identifier hs-type">Ast</span></a></span><span>
</span><span id="line-80"></span><span id="getVarInScope"><span class="annot"><span class="annottext">getVarInScope :: [ScopeMb] -&gt; String -&gt; Maybe Ast
</span><a href="Scope.html#getVarInScope"><span class="hs-identifier hs-var hs-var">getVarInScope</span></a></span></span><span> </span><span id="local-6989586621679066024"><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066024"><span class="hs-identifier hs-var">stack</span></a></span></span><span> </span><span id="local-6989586621679066025"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066025"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><span class="annottext">ScopeMb -&gt; Maybe Ast
</span><a href="Scope.html#getAst"><span class="hs-identifier hs-var">getAst</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeMb -&gt; Maybe Ast) -&gt; Maybe ScopeMb -&gt; Maybe Ast
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(ScopeMb -&gt; Bool) -&gt; [ScopeMb] -&gt; Maybe ScopeMb
forall a. (a -&gt; Bool) -&gt; [a] -&gt; Maybe a
</span><a href="Stack.html#seek"><span class="hs-identifier hs-var">seek</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int -&gt; ScopeMb -&gt; Bool
</span><a href="Scope.html#isSearchedVar"><span class="hs-identifier hs-var">isSearchedVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066025"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ScopeMb] -&gt; Int
</span><a href="Scope.html#getDepth"><span class="hs-identifier hs-var">getDepth</span></a></span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066024"><span class="hs-identifier hs-var">stack</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ScopeMb]
</span><a href="#local-6989586621679066024"><span class="hs-identifier hs-var">stack</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="annot"><span class="hs-comment">-- | Get the 'Ast' at a given 'ScopeMb'</span></span><span>
</span><span id="line-84"></span><span class="annot"><a href="Scope.html#getAst"><span class="hs-identifier hs-type">getAst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-type">ScopeMb</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="AST.html#Ast"><span class="hs-identifier hs-type">Ast</span></a></span><span>
</span><span id="line-85"></span><span id="getAst"><span class="annot"><span class="annottext">getAst :: ScopeMb -&gt; Maybe Ast
</span><a href="Scope.html#getAst"><span class="hs-identifier hs-var hs-var">getAst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scope.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679066029"><span class="annot"><span class="annottext">Ast
</span><a href="#local-6989586621679066029"><span class="hs-identifier hs-var">ast</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ast -&gt; Maybe Ast
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Ast
</span><a href="#local-6989586621679066029"><span class="hs-identifier hs-var">ast</span></a></span><span>
</span><span id="line-86"></span><span class="annot"><a href="Scope.html#getAst"><span class="hs-identifier hs-var">getAst</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeMb
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Ast
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">-- | Return 'True' if the 'ScopeMb' is a Variable</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- by the name passed as parameter and if the variable is in the current scope</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- or global scope</span><span>
</span><span id="line-91"></span><span class="annot"><a href="Scope.html#isSearchedVar"><span class="hs-identifier hs-type">isSearchedVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Scope.html#ScopeMb"><span class="hs-identifier hs-type">ScopeMb</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-92"></span><span id="isSearchedVar"><span class="annot"><span class="annottext">isSearchedVar :: String -&gt; Int -&gt; ScopeMb -&gt; Bool
</span><a href="Scope.html#isSearchedVar"><span class="hs-identifier hs-var hs-var">isSearchedVar</span></a></span></span><span> </span><span id="local-6989586621679066030"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066030"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span id="local-6989586621679066031"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066031"><span class="hs-identifier hs-var">currentDepth</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Scope.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span> </span><span id="local-6989586621679066032"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066032"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Ast
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679066033"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066033"><span class="hs-identifier hs-var">depth</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066032"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066030"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066033"><span class="hs-identifier hs-var">depth</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066033"><span class="hs-identifier hs-var">depth</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679066031"><span class="hs-identifier hs-var">currentDepth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="annot"><a href="Scope.html#isSearchedVar"><span class="hs-identifier hs-var">isSearchedVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ScopeMb
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-95"></span></pre></body></html>